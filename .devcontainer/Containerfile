FROM mcr.microsoft.com/devcontainers/python:1-3.12-bullseye

# Install PostgreSQL server and client
RUN apt-get update && apt-get install -y \
    postgresql \
    postgresql-contrib \
    postgresql-client \
    && rm -rf /var/lib/apt/lists/*

# Configure PostgreSQL to allow local connections
RUN echo "host all all 0.0.0.0/0 md5" >> /etc/postgresql/13/main/pg_hba.conf \
    && echo "listen_addresses='*'" >> /etc/postgresql/13/main/postgresql.conf

# Install uv
COPY --from=ghcr.io/astral-sh/uv:0.9.2 /uv /uvx /bin/
